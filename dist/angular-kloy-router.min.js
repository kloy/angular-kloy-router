!function r(e,t,n){function o(u,a){if(!t[u]){if(!e[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var f=t[u]={exports:{}};e[u][0].call(f.exports,function(r){var t=e[u][1][r];return o(t?t:r)},f,f.exports,r,e,t,n)}return t[u].exports}for(var i="function"==typeof require&&require,u=0;u<n.length;u++)o(n[u]);return o}({1:[function(r){"use strict";var e=window.angular;e.module("kloy.router",[]).constant("KLOY_ROUTER_EVENTS",{ROUTE_CHANGE_START:"kloyRouteChangeStart",ROUTE_CHANGE_SUCCESS:"kloyRouteChangeSuccess",ROUTE_CHANGE_ERROR:"kloyRouteChangeError",ROUTE_CHANGE_REQUEST:"kloyRouteChangeRequest"}).provider("kloyRouter",r("./router")).provider("kloyLayoutManager",r("./layout-manager")).factory("kloyRoute",r("./route")).directive("srRoute",r("./route-directive")).run(["kloyLayoutManager","$rootScope","KLOY_ROUTER_EVENTS",function(r,e,t){e.section=function(e){return r.sections()[e]||null},e.$on(t.ROUTE_CHANGE_SUCCESS,function(){r.sync()})}]).run(["$rootScope","KLOY_ROUTER_EVENTS","kloyRouter","$location","kloyRoute",function(r,e,t,n,o){r.$on(e.ROUTE_CHANGE_REQUEST,function(r,e,n){t.toRoute(e,n)}),r.$on("$locationChangeSuccess",function(r,e,i){var u=n.path(),a=o.path(),c=!0;(c===!0&&u!==a||u!==a&&e!==i)&&(u=n.path(),t.toPath(u)),c=!1})}])},{"./layout-manager":2,"./route":4,"./route-directive":3,"./router":5}],2:[function(r,e){function t(r,e,t){var n={};this.sections=function(){return o.copy(n)},this.sync=function(){Object.keys(r).forEach(function(e){var o=r[e],i={},u=null;i.template=function(r){u=r},t.invoke(o,i),n[e]=u})}}function n(){var r={};this.addSection=function(e,t){var n;if(e in r)throw n="LayoutManagerProvider.addSection() duplicate section ",n+="definition: "+e;return r[e]=t,this},this.$get=["$rootScope","$injector",function(e,n){return new t(r,e,n)}]}var o=window.angular;e.exports=n},{}],3:[function(r,e){var t=["$log","kloyRouter","$compile","$rootScope","$parse",function(r,e,t,n,o){var i={restrict:"A"},u=function(r){return"A"===r[0].tagName.toUpperCase()};return n.srToRoute=function(r,t){e.toRoute(r,t)},i.link=function(r,t,n){var i,a,c,s;s=function(){i=o(n.srRoute)(r),a=n.srParams?o(n.srParams)(r):void 0,c=e.getPathFor(i,a),u(t)&&n.$set("href",c?"#"+c:"")},r.$watch(n.srRoute,s),r.$watch(n.srParams,s),t.on("click",function(){e.toRoute(i,a)})},i}];e.exports=t},{}],4:[function(r,e){var t=window.angular,n=function(){var r,e,n,o,i={};return i._update=function(t){r=t.params||void 0,e=t.name||void 0,n=t.data||void 0,o=t.path||void 0},i.params=function(){return r},i.name=function(){return e},i.data=function(){return t.copy(n)},i.path=function(){return o},i.is=function(r){return i.name()===r},i.not=function(r){return!i.is(r)},i.includes=function(r){return-1!==i.name().indexOf(r)},i.excludes=function(r){return!i.includes(r)},i.startsWith=function(r){return i.name().substring(0,r.length)===r},i.endsWith=function(r){var e=i.name();return e.substring(e.length-r.length)===r},i};e.exports=n},{}],5:[function(r,e){var t=window.angular,n=function(r,e,n,o,i,u,a,c,s){var f,d,h,p,l,v,m,E,R,g,y,w={},_={},k={},$=u.ROUTE_CHANGE_START,O=u.ROUTE_CHANGE_SUCCESS,P=u.ROUTE_CHANGE_ERROR,S=!1;return y=function(r,e){var t={},n=!0;return r.forEach(function(r){t[r]=!0}),e.every(function(r){return t.hasOwnProperty(r)?!0:(n=!1,!1)}),n},g=function(r){return r=r.trim(),r=r.replace(/ +(?= )/g,""),r=r.replace(/ /g,"%20"),r=r.replace(/([^:]\/)\/+/g,"$1"),r=r.toLowerCase(),r="/"!==r.charAt(0)?"/"+r:r,r="/"===r.charAt(r.length-1)?r.substring(0,r.length-1):r},p=function(){t.forEach(r,function(r,e){var n,o;n=_[e]||{},o={permissions:function(r){return t.isDefined(r)&&(n.permissions=r),n.permissions},requiredParams:function(r){return t.isDefined(r)&&(n.requiredParams=r),n.requiredParams},prefetch:function(r){return t.isDefined(r)&&(n.prefetchFn=r),n.prefetchFn},data:function(r){return t.isDefined(r)&&(n.data=t.copy(r)),n.data},path:function(r){return t.isDefined(r)&&(n.path=g(r)),n.path}},n.requiredParams=n.requiredParams||[],r.forEach(function(r){r.bind(o)()}),_[e]=n})},v=function(){t.forEach(_,function(r,e){var n=r.path;if(t.isDefined(n)){if(n in k)throw new Error("router.buildPathsConfig(): path already defined for route "+k[n]+" cannot define duplicate for route "+e);k[n]=e}})},f=function(r){var o,i=[];return r=r||[],o=c.defer(),o.resolve(),i.push(o.promise),r.forEach(function(r){var o,u;if(o=e[r],t.isUndefined(o))throw new Error("router.checkPermissions(): unknown permission "+r);try{u=n.invoke(o)}catch(c){throw a.error("router.checkPermissions(): problem invoking permission",c),c}i.push(u)}),c.all(i)},d=function(r,e){var t,n=c.defer();return r=r||{},t=Object.keys(r),0===e.length?(n.resolve(),n.promise):y(t,e)?(n.resolve(),n.promise):c.reject("missing required param(s)")},h=function(r){var e,o;if(t.isUndefined(r))return o=c.defer(),o.resolve(),o.promise;if(!t.isFunction(r)&&!t.isArray(r))throw new Error("router.prefetch(): argument must be a function, array or undefined");try{e=n.invoke(r)}catch(i){throw a.error("router.doPrefetch(): problem invoking prefetch",i),i}return e},l=function(r,e){var n,i=[];t.isUndefined(r)||(r.split("/").forEach(function(r){i.push(":"===r.charAt(0)?e[r.substr(1)]:r)}),n=i.join("/"),o.path(n))},m=function(r){return t.isDefined(k[r])?!0:E(r)!==!1?!0:!1},E=function(r){var e=!1,t=r.split("/"),n=Object.keys(k);return n.every(function(n){var o,i=n.split("/"),u=[];return i.length!==t.length?!0:(i.forEach(function(r,e){u.push(":"===r.charAt(0)?t[e]:r)}),o=u.join("/"),o!==r?!0:(e=n,!1))}),e},R=function(r,e){var t,n=r.split("/"),o=e.split("/");return n.forEach(function(r,e){":"===r.charAt(0)&&(t=t||{},t[r.substr(1)]=o[e])}),t},w.toPath=function(r){var e,t,n,o;return r=g(r),(e=m(r))?(t=E(r),n=k[t],o=R(t,r),w.toRoute(n,o)):(i.$broadcast(P,{type:"unknown_path",message:"Path "+r+" does not match a route"},void 0,s),c.reject("unknown_path"))},w.toRoute=function(r,e){var n,o,u,p;if(p=_[r],t.isUndefined(p))throw new Error("router.toRoute() unknown route "+r);return S?(o="router.toRoute(): paused, cannot go to "+r,a.debug(o),c.reject(o)):(i.$broadcast($,r,s),u=!1,n=f(p.permissions).then(function(){return d(e,p.requiredParams)},function(e){return u?c.reject(e):(a.debug("router.toRoute(): permissions error",e,r),i.$broadcast(P,{message:e,type:"permissions"},r,s),u=!0,c.reject(e))}).then(function(){return h(p.prefetchFn)},function(e){return u?c.reject(e):(a.debug("router.toRoute(): params error",e,r),i.$broadcast(P,{message:e,type:"params"},r,s),u=!0,c.reject(e))}).then(null,function(e){return u?c.reject(e):(a.debug("router.toRoute(): prefetch error",e,r),i.$broadcast(P,{message:e,type:"prefetch"},r,s),u=!0,c.reject(e))}).then(function(t){var n=p.path;return s._update({params:e,name:r,data:p.data,path:n}),l(n,e),i.$broadcast(O,r,s),t}))},w.getPathFor=function(r,e){var n,o,i;if(e=e||{},i=Object.keys(e),n=_[r],!t.isDefined(n))throw new Error("router.getPathFor(): Unknown route "+r);if(o=n.path||null,!y(i,n.requiredParams))throw new Error("router.getPathFor(): Missing required params for "+r);return t.forEach(e,function(r,e){o=o.replace(":"+e,r)}),o},w.pause=function(){return S=!0,w},w.play=function(){return S=!1,w},p(),v(),w},o=function(){var r={},e={},o={};return r.addRoute=function(t,n){if(t in e)throw new Error("routerProvider.addRoute() route already defined "+t);return e[t]=[n],r},r.modifyRoute=function(n,o){if(t.isUndefined(e[n]))throw new Error("routerProvider.modifyRoute() route not defined "+n);return e[n].push(o),r},r.addPermission=function(e,t){if(e in o)throw new Error("routerProvider.addPermission(): permission already defined");return o[e]=t,r},r.$get=["$injector","$location","$rootScope","KLOY_ROUTER_EVENTS","$log","$q","kloyRoute",function(r,t,i,u,a,c,s){return n(e,o,r,t,i,u,a,c,s)}],r};e.exports=o},{}]},{},[1]);